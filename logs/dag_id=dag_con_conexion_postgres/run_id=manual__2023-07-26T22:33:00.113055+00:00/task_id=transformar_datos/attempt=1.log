[2023-07-26 22:33:18,292] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: dag_con_conexion_postgres.transformar_datos manual__2023-07-26T22:33:00.113055+00:00 [queued]>
[2023-07-26 22:33:18,330] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: dag_con_conexion_postgres.transformar_datos manual__2023-07-26T22:33:00.113055+00:00 [queued]>
[2023-07-26 22:33:18,332] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2023-07-26 22:33:18,335] {taskinstance.py:1377} INFO - Starting attempt 1 of 1
[2023-07-26 22:33:18,337] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2023-07-26 22:33:18,383] {taskinstance.py:1397} INFO - Executing <Task(PythonOperator): transformar_datos> on 2023-07-26 22:33:00.113055+00:00
[2023-07-26 22:33:18,396] {standard_task_runner.py:52} INFO - Started process 2370 to run task
[2023-07-26 22:33:18,416] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'dag_con_conexion_postgres', 'transformar_datos', 'manual__2023-07-26T22:33:00.113055+00:00', '--job-id', '112', '--raw', '--subdir', 'DAGS_FOLDER/dag_etl_paises.py', '--cfg-path', '/tmp/tmpd6aig487', '--error-file', '/tmp/tmp0a4761_7']
[2023-07-26 22:33:18,426] {standard_task_runner.py:80} INFO - Job 112: Subtask transformar_datos
[2023-07-26 22:33:18,871] {task_command.py:371} INFO - Running <TaskInstance: dag_con_conexion_postgres.transformar_datos manual__2023-07-26T22:33:00.113055+00:00 [running]> on host 484a5a9deba0
[2023-07-26 22:33:19,176] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Belenpintor
AIRFLOW_CTX_DAG_ID=dag_con_conexion_postgres
AIRFLOW_CTX_TASK_ID=transformar_datos
AIRFLOW_CTX_EXECUTION_DATE=2023-07-26T22:33:00.113055+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-07-26T22:33:00.113055+00:00
[2023-07-26 22:34:45,755] {logging_mixin.py:115} INFO - name         city  Housing  ... Outdoors               process_date
0          Aarhus  #f3c32c  ...  #f1351b 2023-07-26 22:34:45.696249
1          Aarhus   6.1315  ...     4.13 2023-07-26 22:34:45.696249
2        Adelaide  #f3c32c  ...  #f1351b 2023-07-26 22:34:45.696249
3        Adelaide   6.3095  ...    5.531 2023-07-26 22:34:45.696249
4     Albuquerque  #f3c32c  ...  #f1351b 2023-07-26 22:34:45.696249
..            ...      ...  ...      ...                        ...
527       Yerevan   9.6945  ...   7.7765 2023-07-26 22:34:45.696249
528        Zagreb  #f3c32c  ...  #f1351b 2023-07-26 22:34:45.696249
529        Zagreb     8.91  ...    4.809 2023-07-26 22:34:45.696249
530        Zurich  #f3c32c  ...  #f1351b 2023-07-26 22:34:45.696249
531        Zurich    1.473  ...    5.401 2023-07-26 22:34:45.696249

[532 rows x 19 columns]
[2023-07-26 22:34:47,052] {logging_mixin.py:115} INFO - INSERT: 
    INSERT INTO public.ciudades (
        city,
        "Housing",
        "Cost of Living",
        "Startups",
        "Venture Capital",
        "Travel Connectivity",
        "Commute",
        "Business Freedom",
        "Safety",
        "Healthcare",
        "Education",
        "Environmental Quality",
        "Economy",
        "Taxation",
        "Internet Access",
        "Leisure & Culture",
        "Tolerance",
        "Outdoors",
        "process_date"  -- Agregar la columna "process_date"
    ) VALUES (
        %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s
    )
[2023-07-26 22:34:47,057] {logging_mixin.py:115} INFO - VALUES: ['Aarhus', '#f3c32c', '#f3d630', '#f4eb33', '#d2ed31', '#7adc29', '#36cc24', '#19ad51', '#0d6999', '#051fa5', '#150e78', '#3d14a4', '#5c14a1', '#88149f', '#b9117d', '#d10d54', '#e70c26', '#f1351b', Timestamp('2023-07-26 22:34:45.696249')]
[2023-07-26 22:34:47,059] {taskinstance.py:1909} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/script_etl.py", line 83, in transform_data
    cursor.execute(insert_query, values)
IndexError: list index out of range
[2023-07-26 22:34:47,102] {taskinstance.py:1420} INFO - Marking task as FAILED. dag_id=dag_con_conexion_postgres, task_id=transformar_datos, execution_date=20230726T223300, start_date=20230726T223318, end_date=20230726T223447
[2023-07-26 22:34:47,142] {standard_task_runner.py:97} ERROR - Failed to execute job 112 for task transformar_datos (list index out of range; 2370)
[2023-07-26 22:34:47,293] {local_task_job.py:156} INFO - Task exited with return code 1
[2023-07-26 22:34:47,443] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
