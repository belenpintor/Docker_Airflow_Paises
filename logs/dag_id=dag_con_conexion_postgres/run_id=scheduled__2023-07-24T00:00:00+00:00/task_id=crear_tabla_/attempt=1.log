[2023-07-25 22:30:54,441] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: dag_con_conexion_postgres.crear_tabla_ scheduled__2023-07-24T00:00:00+00:00 [queued]>
[2023-07-25 22:30:54,519] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: dag_con_conexion_postgres.crear_tabla_ scheduled__2023-07-24T00:00:00+00:00 [queued]>
[2023-07-25 22:30:54,526] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2023-07-25 22:30:54,528] {taskinstance.py:1377} INFO - Starting attempt 1 of 1
[2023-07-25 22:30:54,532] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2023-07-25 22:30:54,674] {taskinstance.py:1397} INFO - Executing <Task(PostgresOperator): crear_tabla_> on 2023-07-24 00:00:00+00:00
[2023-07-25 22:30:54,711] {standard_task_runner.py:52} INFO - Started process 254 to run task
[2023-07-25 22:30:54,743] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'dag_con_conexion_postgres', 'crear_tabla_', 'scheduled__2023-07-24T00:00:00+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/dag_etl_paises.py', '--cfg-path', '/tmp/tmp3_hpn7cu', '--error-file', '/tmp/tmpndpfwqkq']
[2023-07-25 22:30:54,749] {standard_task_runner.py:80} INFO - Job 39: Subtask crear_tabla_
[2023-07-25 22:30:55,410] {task_command.py:371} INFO - Running <TaskInstance: dag_con_conexion_postgres.crear_tabla_ scheduled__2023-07-24T00:00:00+00:00 [running]> on host 484a5a9deba0
[2023-07-25 22:30:55,763] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Belenpintor
AIRFLOW_CTX_DAG_ID=dag_con_conexion_postgres
AIRFLOW_CTX_TASK_ID=crear_tabla_
AIRFLOW_CTX_EXECUTION_DATE=2023-07-24T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-07-24T00:00:00+00:00
[2023-07-25 22:30:55,784] {base.py:68} INFO - Using connection ID 'redshift_belen' for task execution.
[2023-07-25 22:30:56,730] {taskinstance.py:1909} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/postgres/operators/postgres.py", line 92, in execute
    self.hook.run(self.sql, self.autocommit, parameters=self.parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/dbapi.py", line 204, in run
    with closing(self.get_conn()) as conn:
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/postgres/hooks/postgres.py", line 113, in get_conn
    self.conn = psycopg2.connect(**conn_args)
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "data-engineer-cluster.cyhh5bfevlmn.us-east-1.redshift.amazonaws.com" (52.44.43.227), port 5439 failed: FATAL:  database "bapintor_coderhouse" does not exist

[2023-07-25 22:30:56,777] {taskinstance.py:1420} INFO - Marking task as FAILED. dag_id=dag_con_conexion_postgres, task_id=crear_tabla_, execution_date=20230724T000000, start_date=20230725T223054, end_date=20230725T223056
[2023-07-25 22:30:56,881] {standard_task_runner.py:97} ERROR - Failed to execute job 39 for task crear_tabla_ (connection to server at "data-engineer-cluster.cyhh5bfevlmn.us-east-1.redshift.amazonaws.com" (52.44.43.227), port 5439 failed: FATAL:  database "bapintor_coderhouse" does not exist
; 254)
[2023-07-25 22:30:56,963] {local_task_job.py:156} INFO - Task exited with return code 1
[2023-07-25 22:30:57,258] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-07-28 21:50:19,865] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: dag_con_conexion_postgres.crear_tabla_ scheduled__2023-07-24T00:00:00+00:00 [queued]>
[2023-07-28 21:50:22,161] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: dag_con_conexion_postgres.crear_tabla_ scheduled__2023-07-24T00:00:00+00:00 [queued]>
[2023-07-28 21:50:22,208] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2023-07-28 21:50:22,213] {taskinstance.py:1377} INFO - Starting attempt 1 of 2
[2023-07-28 21:50:22,214] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2023-07-28 21:50:22,888] {taskinstance.py:1397} INFO - Executing <Task(PostgresOperator): crear_tabla_> on 2023-07-24 00:00:00+00:00
[2023-07-28 21:50:23,007] {standard_task_runner.py:52} INFO - Started process 199 to run task
[2023-07-28 21:50:23,277] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'dag_con_conexion_postgres', 'crear_tabla_', 'scheduled__2023-07-24T00:00:00+00:00', '--job-id', '231', '--raw', '--subdir', 'DAGS_FOLDER/dag_etl_paises.py', '--cfg-path', '/tmp/tmpsnfw1pch', '--error-file', '/tmp/tmps4kg7len']
[2023-07-28 21:50:23,325] {standard_task_runner.py:80} INFO - Job 231: Subtask crear_tabla_
[2023-07-28 21:50:26,526] {task_command.py:371} INFO - Running <TaskInstance: dag_con_conexion_postgres.crear_tabla_ scheduled__2023-07-24T00:00:00+00:00 [running]> on host ed56ff05d916
[2023-07-28 21:50:31,371] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Belenpintor
AIRFLOW_CTX_DAG_ID=dag_con_conexion_postgres
AIRFLOW_CTX_TASK_ID=crear_tabla_
AIRFLOW_CTX_EXECUTION_DATE=2023-07-24T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-07-24T00:00:00+00:00
[2023-07-28 21:50:31,786] {base.py:68} INFO - Using connection ID 'redshift_belen' for task execution.
[2023-07-28 21:50:35,370] {dbapi.py:231} INFO - Running statement: 
CREATE TABLE IF NOT EXISTS bapintor_coderhouse.ciudades (
    city VARCHAR PRIMARY KEY,
    "Housing" DECIMAL(10, 2),
    "Cost of Living" DECIMAL(10, 2),
    "Startups" DECIMAL(10, 2),
    "Venture Capital" DECIMAL(10, 2),
    "Travel Connectivity" DECIMAL(10, 2),
    "Commute" DECIMAL(10, 2),
    "Business Freedom" DECIMAL(10, 2),
    "Safety" DECIMAL(10, 2),
    "Healthcare" DECIMAL(10, 2),
    "Education" DECIMAL(10, 2),
    "Environmental Quality" DECIMAL(10, 2),
    "Economy" DECIMAL(10, 2),
    "Taxation" DECIMAL(10, 2),
    "Internet Access" DECIMAL(10, 2),
    "Leisure & Culture" DECIMAL(10, 2),
    "Tolerance" DECIMAL(10, 2),
    "Outdoors" DECIMAL(10, 2),
    "process_date" DATETIME DISTKEY
);, parameters: None
[2023-07-28 21:50:35,817] {postgres.py:94} INFO - INFO:  Relation "ciudades" already exists and will be skipped

[2023-07-28 21:50:36,297] {taskinstance.py:1420} INFO - Marking task as SUCCESS. dag_id=dag_con_conexion_postgres, task_id=crear_tabla_, execution_date=20230724T000000, start_date=20230728T215021, end_date=20230728T215036
[2023-07-28 21:50:37,750] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-07-28 21:50:40,851] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
